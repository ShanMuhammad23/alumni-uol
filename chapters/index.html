<!doctype html>
<html class="no-js" lang="zxx">

<head>
   <meta charset="utf-8">
   <meta http-equiv="x-ua-compatible" content="ie=edge">
   <title>Alumni Chapters | UOL Alumni</title>
   <meta name="description" content="">
   <meta name="viewport" content="width=device-width, initial-scale=1">

   <link rel="shortcut icon" type="image/x-icon" href="/assets/img/icon/favicon.ico">

   <link rel="stylesheet" href="/assets/css/bootstrap.css">
   <link rel="stylesheet" href="/assets/css/animate.css">
   <link rel="stylesheet" href="/assets/css/swiper-bundle.css">
   <link rel="stylesheet" href="/assets/css/slick.css">
   <link rel="stylesheet" href="/assets/css/magnific-popup.css">
   <link rel="stylesheet" href="/assets/css/font-awesome-pro.css">
   <link rel="stylesheet" href="/assets/css/spacing.css">
   <link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>

   <!-- pre loader area start -->
   <div id="loading">
      <div id="loading-center">
         <div id="loading-center-absolute">
            <div class="tp-preloader-content">
               <div class="tp-preloader-logo">
                  <div class="tp-preloader-circle">
                     <svg width="190" height="190" viewBox="0 0 380 380" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle stroke="#D9D9D9" cx="190" cy="190" r="180" stroke-width="6" stroke-linecap="round"></circle>
                        <circle stroke="red" cx="190" cy="190" r="180" stroke-width="6" stroke-linecap="round"></circle>
                     </svg>
                  </div>
                  <img src="/assets/img/brand/short-logo.png" alt="">
               </div>
               <p class="tp-preloader-subtitle">Loading...</p>
            </div>
         </div>
      </div>
   </div>
   <!-- pre loader area end -->

   <!-- back to top start -->
   <div class="back-to-top-wrapper">
      <button id="back_to_top" type="button" class="back-to-top-btn">
         <svg width="12" height="7" viewBox="0 0 12 7" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11 6L6 1L1 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
         </svg>
      </button>
   </div>
   <!-- back to top end -->

   <header class="header-area tp-header-transparent p-relative">
      <div id="header-sticky" class="tp-header-mob-space tp-header-1">
         <div class="pl-40 pr-40">
            <div class="row align-items-center">
               <div class="col-xxl-2 col-xl-2 col-lg-6 col-md-6 col-6">
                  <div class="tp-header-logo-1 tp-header-logo">
                     <a href="/">
                        <img class="logo-1" src="/assets/img/brand/logo-white.png" alt="logo">
                        <img class="logo-2" src="/assets/img/brand/logo-black.png" alt="logo">
                     </a>
                  </div>
               </div>
               <div class="col-xxl-8 col-xl-7 d-none d-xl-block">
                  <div class="main-menu text-center">
                     <nav class="tp-main-menu-content">
                        <ul>
                           <li class="tp-static"><a class="tp-static" href="/">Home</a></li>
                           <li><a href="/about/">About</a></li>
                           <li><a href="/jobs/">Jobs</a></li>
                           <li><a href="/events/">Events</a></li>
                           <li><a href="/benefits/">Perks & Benefits</a></li>
                           <li><a href="/give-back/">Give Back</a></li>
                           <li><a href="/associations/">Associations</a></li>
                           <li><a href="/chapters/">Chapters</a></li>
                           <li><a href="/newsletters/">Newsletters</a></li>
                           <li><a href="/contact/">Contact</a></li>
                        </ul>
                     </nav>
                  </div>
               </div>
               <div class="col-xxl-2 col-xl-3 col-lg-6 col-md-6 col-6">
                  <div class="tp-header-contact d-flex align-items-center justify-content-end">
                     <div class="tp-header-btn d-none d-md-block ml-30">
                        <a href="https://portal-alumni.uol.edu.pk/signin" target="_blank">Alumni Login</a>
                     </div>
                     <div class="tp-header-bar d-xl-none ml-30">
                        <button class="offcanvas-open-btn"><i class="fa-solid fa-bars"></i></button>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </header>
   <!-- header-area-end -->
   <!-- offcanvas area start -->
   <div class="offcanvas__area">
      <div class="offcanvas__wrapper">
         <div class="offcanvas__close">
            <button class="offcanvas__close-btn offcanvas-close-btn">
               <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11 1L1 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M1 1L11 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
               </svg>
            </button>
         </div>
         <div class="offcanvas__content">
            <div class="offcanvas__top mb-90 d-flex justify-content-between align-items-center">
               <div class="offcanvas__logo tp-header-logo">
                  <a href="/">
                     <img src="/assets/img/brand/logo-black.png" alt="logo">
                  </a>
               </div>
            </div>
            <div class="offcanvas-main">
               <div class="tp-main-menu-mobile d-xl-none"></div>
            </div>
         </div>
      </div>
   </div>
   <div class="body-overlay"></div>
   <!-- offcanvas area end -->
   <main>
      <section class="tp-breadcrumb__area pt-160 pb-150 p-relative z-index-1 fix red-shadow">
         
         <div class="container">
            <div class="row align-items-center">
               <div class="col-sm-12">
                  <div class="tp-breadcrumb__content">
                     <div class="tp-breadcrumb__list inner-after">
                        <span class="white"><a href="index.html"><svg width="17" height="14" viewBox="0 0 17 14"
                                 fill="none" xmlns="http://www.w3.org/2000/svg">
                                 <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M8.07207 0C8.19331 0 8.31107 0.0404348 8.40664 0.114882L16.1539 6.14233L15.4847 6.98713L14.5385 6.25079V12.8994C14.538 13.1843 14.4243 13.4574 14.2225 13.6589C14.0206 13.8604 13.747 13.9738 13.4616 13.9743H2.69231C2.40688 13.9737 2.13329 13.8603 1.93146 13.6588C1.72962 13.4573 1.61597 13.1843 1.61539 12.8994V6.2459L0.669148 6.98235L0 6.1376L7.7375 0.114882C7.83308 0.0404348 7.95083 0 8.07207 0ZM8.07694 1.22084L2.69231 5.40777V12.8994H13.4616V5.41341L8.07694 1.22084Z"
                                    fill="currentColor" />
                              </svg></a></span>
                        <span class="white">Alumni Chapters</span>
                     </div>
                     <h3 class="tp-breadcrumb__title color">Alumni Chapters</h3>
                  </div>
               </div>
            </div>
         </div>
      </section>

      <section class="program-area pt-10 pb-90">
         <div class="container">
            <!-- Members Dashboard Cards -->
            <div class="row mb-20">
               <div class="col-lg-4 col-md-6 mb-20">
                  <div class="dashboard-card">
                    
                     <div class="dashboard-card__number" id="chapters-total-members">0</div>
                     <div class="dashboard-card__label">Total Members</div>
                  </div>
               </div>
               <div class="col-lg-4 col-md-6 mb-20">
                  <div class="dashboard-card">
                    
                     <div class="dashboard-card__number" id="chapters-national-members">0</div>
                     <div class="dashboard-card__label">National Members</div>
                  </div>
               </div>
               <div class="col-lg-4 col-md-6 mb-20">
                  <div class="dashboard-card">
                     
                     <div class="dashboard-card__number" id="chapters-international-members">0</div>
                     <div class="dashboard-card__label">International Members</div>
                  </div>
               </div>
            </div>
          
            <!-- Chapters Loader -->
            <div id="chapters-loader" class="text-center py-80">
               <div class="tp-preloader-content">
                  <div class="tp-preloader-logo">
                     <div class="tp-preloader-circle">
                        <svg width="190" height="190" viewBox="0 0 380 380" fill="none" xmlns="http://www.w3.org/2000/svg">
                           <circle stroke="#D9D9D9" cx="190" cy="190" r="180" stroke-width="6" stroke-linecap="round"></circle>
                           <circle stroke="red" cx="190" cy="190" r="180" stroke-width="6" stroke-linecap="round"></circle>
                        </svg>
                     </div>
                    
                  </div>
                  <p class="tp-preloader-subtitle" style="color: black;">Loading Chapters...</p>
               </div>
            </div>

            <!-- International Chapters Section -->
            <div class="chapter-section-wrapper mb-80" id="international-chapters-section" style="display: none;">
               <div class="chapter-section-header d-flex align-items-center justify-content-between mb-40">
                  <h4 class="tp-section-title mb-0 text-center flex-grow-1">International Chapters</h4>
                  <button class="chapter-toggle-btn" type="button" aria-expanded="true" aria-controls="international-chapters-collapse">
                     <i class="fa-solid fa-chevron-down"></i>
                  </button>
               </div>
               <div class="chapter-collapsible-content" id="international-chapters-collapse" style="transform-origin: top; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease-in-out, max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);">
                  <div class="row" id="international-chapters-list">
                     <!-- International chapters will be loaded here -->
                  </div>
               </div>
            </div>

            <!-- National Chapters Section -->
            <div class="chapter-section-wrapper mb-80" id="national-chapters-section" style="display: none;">
               <div class="chapter-section-header d-flex align-items-center justify-content-between mb-40">
                  <h4 class="tp-section-title mb-0 text-center flex-grow-1">National Chapters</h4>
                  <button class="chapter-toggle-btn" type="button" aria-expanded="true" aria-controls="local-chapters-collapse">
                     <i class="fa-solid fa-chevron-down"></i>
                  </button>
               </div>
               <div class="chapter-collapsible-content" id="local-chapters-collapse" style="transform-origin: top; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease-in-out, max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);">
                  <div class="row" id="local-chapters-list">
                     <!-- Local chapters will be loaded here -->
                  </div>
               </div>
            </div>
           
         </div>
      </section>
   </main>

   <!-- footer-area-start -->
   <footer>
      <div class="tp-footer-main pt-80 pb-55" style="background-color: #f5f5f5;">
         <div class="container">
            <div class="row">
               <div class="col-xl-4 col-lg-3 col-sm-6">
                  <div class="tp-footer-widget tp-footer-col-1 mb-30">
                     <div class="tp-footer-widget-logo mb-20 tp-header-logo">
                        <a href="/"><img src="/assets/img/brand/logo-black.png" alt="" style="width: 200px;"></a>
                     </div>
                  </div>
               </div>
               <div class="col-xl-2 col-lg-3 col-sm-6">
                  <div class="tp-footer-widget tp-footer-col-2 mb-30">
                     <h4 class="tp-footer-widget-title mb-20">Quick Links</h4>
                     <div class="tp-footer-widget-link">
                        <ul>
                             <li><a href="/about/">About Us</a></li>
                           <li><a href="/jobs/">Jobs</a></li>
                           <li><a href="/events/">Events</a></li>
                           <li><a href="/newsletters/">Newsletters</a></li>
                           <li><a href="/contact/">Contact Us</a></li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="col-xl-2 col-lg-2 col-sm-4">
                  <div class="tp-footer-widget tp-footer-col-3 mb-30">
                     <h4 class="tp-footer-widget-title mb-20">Alumni</h4>
                     <div class="tp-footer-widget-link">
                        <ul>
                           <li><a href="/benefits/">Alumni Perks & Benefits</a></li>
                           <li><a href="/give-back/">Give Back</a></li>
                           <li><a href="/associations/">Alumni Associations</a></li>
                           <li><a href="/chapters/">Alumni Chapters</a></li>
                           
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="col-xl-4 col-lg-4 col-sm-8">
                  <div class="p-footer-widget tp-footer-col-4 mb-30">
                     <div class="tp-footer-newsletter-wrap">
                        <div class="tp-footer-newsletter-social">
                           <a class="social-fb" href="https://www.facebook.com/Uni.Lhr.AlumniRelations" target="_blank"><i class="fa-brands fa-facebook-f"></i></a>
                           <a class="social-lnkd" href="https://www.linkedin.com/company/uol-alumni-relations" target="_blank"><i class="fa-brands fa-linkedin-in"></i></a>
                           <a class="social-yout" href="https://www.instagram.com/oar.uol" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div class="tp-footer-bottom">
         <div class="container">
            <div class="row">
               <div class="col-lg-12">
                  <div class="tp-footer-copyright text-center">
                     <span>¬© 2025 <a href="#">UoL Alumni</a>. All rights reserved by The University of Lahore</span>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </footer>
   <!-- footer-area-end -->

   <!-- JS here -->
   <script src="/assets/js/vendor/jquery.js"></script>
   <script src="/assets/js/vendor/waypoints.js"></script>
   <script src="/assets/js/bootstrap-bundle.js"></script>
   <script src="/assets/js/swiper-bundle.js"></script>
   <script src="/assets/js/slick.js"></script>
   <script src="/assets/js/magnific-popup.js"></script>
   <script src="/assets/js/nice-select.js"></script>
   <script src="/assets/js/purecounter.js"></script>
   <script src="/assets/js/wow.js"></script>
   <script src="/assets/js/isotope-pkgd.js"></script>
   <script src="/assets/js/hover-reveal.js"></script>
   <script src="/assets/js/tween-max.js"></script>
   <script src="/assets/js/imagesloaded-pkgd.js"></script>
   <script src="/assets/js/flatpickr.js"></script>
   <script src="/assets/js/ajax-form.js"></script>
   <script src="/assets/js/main.js"></script>

   <!-- Supabase Client Library -->
   <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

   <style>
      /* Ensure chapter cards are equal height */
      #local-chapters-list,
      #international-chapters-list {
         display: flex;
         flex-wrap: wrap;
      }
      #local-chapters-list > [class*="col-"],
      #international-chapters-list > [class*="col-"] {
         display: flex;
      }

      /* Chapter Card Styling - Equal Heights and Alignment */
      .tp-financial-item {
         display: flex;
         flex-direction: column;
         height: 100%;
      }

      .tp-financial-thumb {
         flex-shrink: 0;
         height: 220px;
         min-height: 220px;
         display: flex;
         align-items: center;
         justify-content: center;
      }

      .tp-financial-content {
         display: flex;
         flex-direction: column;
         flex: 1;
         padding: 25px;
      }

      .tp-financial-content > div:first-child {
         display: flex;
         flex-direction: column;
         flex: 1;
         min-height: 0;
      }

      .tp-financial-content-title {
         margin-bottom: 15px;
         min-height: 50px;
         display: flex;
         align-items: center;
      }

      .tp-financial-content p {
         flex: 1;
         margin-bottom: 15px;
         min-height: 60px;
         display: -webkit-box;
         -webkit-line-clamp: 3;
         line-clamp: 3;
         -webkit-box-orient: vertical;
         overflow: hidden;
         text-overflow: ellipsis;
      }

      .tp-financial-content .d-flex.align-items-center {
         margin-top: auto;
         margin-bottom: 15px;
         min-height: 30px;
      }

      .tp-about-btn {
         margin-top: auto;
         padding-top: 15px;
      }

      /* Collapsible Chapter Sections */
      .chapter-section-wrapper {
         position: relative;
      }

      .chapter-section-header {
         cursor: pointer;
         user-select: none;
      }

      .chapter-toggle-btn {
         background: transparent;
         border: 2px solid var(--tp-theme-primary, #AB0C2F);
         color: var(--tp-theme-primary, #AB0C2F);
         width: 45px;
         height: 45px;
         border-radius: 50%;
         display: flex;
         align-items: center;
         justify-content: center;
         transition: all 0.3s ease;
         cursor: pointer;
         flex-shrink: 0;
         margin-left: 20px;
      }

      .chapter-toggle-btn:hover {
         background: var(--tp-theme-primary, #AB0C2F);
         color: white;
         transform: scale(1.1);
      }

      .chapter-toggle-btn i {
         transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
         font-size: 18px;
      }

      .chapter-toggle-btn[aria-expanded="false"] i {
         transform: rotate(-180deg);
      }

      .chapter-collapsible-content {
         overflow: hidden;
         max-height: 10000px;
         opacity: 1;
         transform: scaleY(1);
      }

      .chapter-collapsible-content.collapsed {
         max-height: 0;
         opacity: 0;
         transform: scaleY(0);
         margin-bottom: 0;
      }

      /* Chapters Loader Styling */
      #chapters-loader {
         min-height: 400px;
         display: flex;
         align-items: center;
         justify-content: center;
      }

      #chapters-loader .tp-preloader-content {
         text-align: center;
      }

      #chapters-loader .tp-preloader-logo {
         position: relative;
         display: inline-block;
         margin-bottom: 20px;
      }

      #chapters-loader .tp-preloader-circle {
         position: relative;
         width: 120px;
         height: 120px;
         margin: 0 auto;
         animation: rotate 2s linear infinite;
      }

      #chapters-loader .tp-preloader-circle svg {
         width: 100%;
         height: 100%;
      }

      #chapters-loader .tp-preloader-circle circle:last-child {
         stroke-dasharray: 565;
         stroke-dashoffset: 565;
         animation: dash 1.5s ease-in-out infinite;
      }

      #chapters-loader .tp-preloader-logo img {
         position: absolute;
         top: 50%;
         left: 50%;
         transform: translate(-50%, -50%);
         width: 60px;
         height: 60px;
         object-fit: contain;
      }

      #chapters-loader .tp-preloader-subtitle {
         color: var(--tp-theme-primary, #AB0C2F);
         font-size: 18px;
         font-weight: 500;
         margin-top: 20px;
      }

      @keyframes rotate {
         100% {
            transform: rotate(360deg);
         }
      }

      @keyframes dash {
         0% {
            stroke-dashoffset: 565;
         }
         50% {
            stroke-dashoffset: 0;
         }
         100% {
            stroke-dashoffset: -565;
         }
      }

      /* Dashboard Card Styles */
      .dashboard-card {
         background: linear-gradient(135deg, rgba(171, 12, 47, 0.05) 0%, rgba(171, 12, 47, 0.02) 100%);
         border: 1px solid rgba(171, 12, 47, 0.15);
         border-radius: 16px;
         padding: 30px;
         text-align: center;
         transition: all 0.3s ease;
         box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .dashboard-card:hover {
         transform: translateY(-4px);
         box-shadow: 0 8px 24px rgba(171, 12, 47, 0.15);
         border-color: rgba(171, 12, 47, 0.3);
      }

      .dashboard-card__icon {
         width: 64px;
         height: 64px;
         margin: 0 auto 20px;
         background: linear-gradient(135deg, var(--tp-theme-primary, #AB0C2F), rgba(171, 12, 47, 0.8));
         border-radius: 16px;
         display: flex;
         align-items: center;
         justify-content: center;
         color: white;
         font-size: 28px;
      }

      .dashboard-card__number {
         font-size: 42px;
         font-weight: 700;
         color: var(--tp-theme-primary, #AB0C2F);
         margin-bottom: 8px;
         line-height: 1.2;
      }

      .dashboard-card__label {
         font-size: 16px;
         color: #666;
         font-weight: 500;
         text-transform: uppercase;
         letter-spacing: 0.5px;
      }

      @media (max-width: 768px) {
         .chapter-section-header {
            flex-direction: column;
            gap: 15px;
         }
         .chapter-toggle-btn {
            margin-left: 0;
         }
         .tp-financial-thumb {
            height: 180px;
            min-height: 180px;
         }
         .tp-financial-content-title {
            min-height: auto;
         }
         .tp-financial-content p {
            min-height: auto;
            -webkit-line-clamp: 2;
            line-clamp: 2;
         }
         #chapters-loader {
            min-height: 300px;
         }
         #chapters-loader .tp-preloader-circle {
            width: 100px;
            height: 100px;
         }
         #chapters-loader .tp-preloader-logo img {
            width: 50px;
            height: 50px;
         }
         .dashboard-card {
            padding: 24px 20px;
         }
         .dashboard-card__icon {
            width: 56px;
            height: 56px;
            font-size: 24px;
            margin-bottom: 16px;
         }
         .dashboard-card__number {
            font-size: 36px;
         }
         .dashboard-card__label {
            font-size: 14px;
         }
      }
   </style>

   <script>
      // Supabase Configuration (for fetching chapter member counts)
      const SUPABASE_URL = 'https://gjtcqhtwbohebbovgaou.supabase.co';
      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqdGNxaHR3Ym9oZWJib3ZnYW91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3NjU3NjYsImV4cCI6MjA3ODM0MTc2Nn0.GxU2S48TD7ZRFqzMbE5XXbkTcQKTmoccU_9e8rwmKzE';

      // Initialize Supabase client
      const supabase = window.supabase?.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

      // Fetch member count for a chapter using alumni_chapter table
      async function getChapterMemberCount(chapterId) {
         if (!supabase || !chapterId) return 0;

         try {
            const { count, error } = await supabase
               .from('alumni_chapter')
               .select('*', { count: 'exact', head: true })
               .or(`chapter1.eq.${chapterId},chapter2.eq.${chapterId},chapter3.eq.${chapterId}`);

            if (error) {
               console.error('Error fetching chapter member count:', error);
               return 0;
            }

            return count || 0;
         } catch (error) {
            console.error('Unexpected error fetching chapter member count:', error);
            return 0;
         }
      }

      // Flag emoji mapping for international chapters
      const flagIcons = {
         'Saudi Arabia Chapter': 'üá∏üá¶',
         'United States Chapter': 'üá∫üá∏',
         'United Arab Emirates Chapter': 'üá¶üá™',
         'Germany-Austria Chapter': 'üá©üá™',
         'United Kingdom Chapter': 'üá¨üáß',
         'Canada Chapter': 'üá®üá¶',
         'Ireland Chapter': 'üáÆüá™',
         'Qatar Chapter': 'üá∂üá¶',
         'Bahrain Chapter': 'üáßüá≠',
         'China Chapter': 'üá®üá≥',
         'Kuwait Chapter': 'üá∞üáº',
         'Italy Chapter': 'üáÆüáπ',
         'Oman Chapter': 'üá¥üá≤',
         'Australia Chapter': 'üá¶üá∫'
      };

      // Load chapters from JSON file
      async function loadChapters() {
         const localContainer = document.getElementById('local-chapters-list');
         const internationalContainer = document.getElementById('international-chapters-list');
         const loader = document.getElementById('chapters-loader');
         const internationalSection = document.getElementById('international-chapters-section');
         const nationalSection = document.getElementById('national-chapters-section');

         // Show loader, hide sections
         if (loader) loader.style.display = 'block';
         if (internationalSection) internationalSection.style.display = 'none';
         if (nationalSection) nationalSection.style.display = 'none';

         try {
            // Fetch chapters from JSON file
            const response = await fetch('/assets/data/chapters.json');
            
            if (!response.ok) {
               throw new Error('Failed to fetch chapters data');
            }

            const data = await response.json();
            
            if (!data || (!data.local && !data.international)) {
               throw new Error('Invalid chapters data structure');
            }

            // Load National Chapters (local)
            let totalMembers = 0;
            let nationalMembers = 0;
            let internationalMembers = 0;
            
            if (data.local && data.local.length > 0) {
               // Fetch member counts for local chapters in parallel
               const localChaptersWithCounts = await Promise.all(
                  data.local.map(async (chapter) => {
                     const dbCount = await getChapterMemberCount(chapter.id);
                     const memberCount = dbCount > 0 ? dbCount : (chapter.members || 0);
                     return {
                        ...chapter,
                        memberCount: typeof memberCount === 'number' ? memberCount : 0
                     };
                  })
               );
               
               // Add local chapter members to totals
               localChaptersWithCounts.forEach(chapter => {
                  const count = chapter.memberCount || 0;
                  nationalMembers += count;
                  totalMembers += count;
               });

               localChaptersWithCounts.forEach(chapter => {
                  const col = document.createElement('div');
                  col.className = 'col-lg-4 col-md-6 mb-30';
                  const chapterName = chapter.name || 'Chapter';
                  const chapterDescription = chapter.description || '';
                  const isActive = chapter.status === 'active';
                  const chapterImage = chapter.image || null;
                  
                  col.innerHTML = `
                     <div class="tp-financial-item mb-30 h-100">
                        <div class="tp-financial-thumb" style="background: #f8f9fa; padding: 0; overflow: hidden;">
                           ${chapterImage ? 
                              `<img src="${chapterImage}" alt="${chapterName}" style="width: 100%; height: 100%; object-fit: cover;">` :
                              `<div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; padding: 30px;">
                                 <i class="fa-solid fa-map-marker-alt" style="font-size: 60px; color: var(--tp-theme-primary, #AB0C2F);"></i>
                              </div>`
                           }
                        </div>
                           <div class="tp-financial-content">
                              <div>
                                 <h4 class="tp-financial-content-title"><a href="/chapters/detail.html?id=${chapter.id}">${chapterName}</a></h4>
                                 <p>${chapterDescription}</p>
                                 <div class="d-flex align-items-center flex-wrap gap-2">
                                    <span class="badge ${isActive ? 'bg-success' : 'bg-secondary'}">${isActive ? 'Active' : 'Upcoming'}</span>
                                    <span class="d-inline-flex align-items-center gap-1 text-muted" style="font-size: 14px;">
                                       <i class="fa-solid fa-users"></i>
                                       <span>${chapter.memberCount.toLocaleString()} Members</span>
                                    </span>
                                 </div>
                              </div>
                              <div class="tp-about-btn">
                                 <a class="tp-btn tp-btn-sm" href="/chapters/detail.html?id=${chapter.id}">Learn More</a>
                              </div>
                           </div>
                     </div>
                  `;
                  localContainer.appendChild(col);
               });
            } else {
               localContainer.innerHTML = '<div class="col-12"><p class="text-center">No national chapters available.</p></div>';
            }

            // Load International Chapters
            if (data.international && data.international.length > 0) {
               // Fetch member counts for international chapters in parallel
               const internationalChaptersWithCounts = await Promise.all(
                  data.international.map(async (chapter) => {
                     const dbCount = await getChapterMemberCount(chapter.id);
                     const memberCount = dbCount > 0 ? dbCount : (chapter.members || 0);
                     return {
                        ...chapter,
                        memberCount: typeof memberCount === 'number' ? memberCount : 0
                     };
                  })
               );
               
               // Add international chapter members to totals
               internationalChaptersWithCounts.forEach(chapter => {
                  const count = chapter.memberCount || 0;
                  internationalMembers += count;
                  totalMembers += count;
               });

               internationalChaptersWithCounts.forEach(chapter => {
                  const col = document.createElement('div');
                  col.className = 'col-lg-4 col-md-6 mb-30';
                  const chapterName = chapter.name || 'Chapter';
                  const chapterDescription = chapter.description || '';
                  const isActive = chapter.status === 'active';
                  const chapterImage = chapter.image || null;
                  const flagIcon = flagIcons[chapterName] || 'üåç';
                  
                  col.innerHTML = `
                     <div class="tp-financial-item mb-30 h-100">
                        <div class="tp-financial-thumb" style="background: #f8f9fa; padding: 0; overflow: hidden; display: flex; align-items: center; justify-content: center;">
                           ${chapterImage ? 
                              `<img src="${chapterImage}" alt="${chapterName}" style="width: 100%; height: 100%; object-fit: cover;">` :
                              `<div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; padding: 30px;">
                                 <span style="font-size: 80px;">${flagIcon}</span>
                              </div>`
                           }
                        </div>
                           <div class="tp-financial-content">
                              <div>
                                 <h4 class="tp-financial-content-title"><a href="/chapters/detail.html?id=${chapter.id}">${chapterName}</a></h4>
                                 <p>${chapterDescription}</p>
                                 <div class="d-flex align-items-center flex-wrap gap-2">
                                    <span class="badge ${isActive ? 'bg-success' : 'bg-warning'}">${isActive ? 'Active' : 'Coming Soon'}</span>
                                    <span class="d-inline-flex align-items-center gap-1 text-muted" style="font-size: 14px;">
                                       <i class="fa-solid fa-users"></i>
                                       <span>${chapter.memberCount.toLocaleString()} Members</span>
                                    </span>
                                 </div>
                              </div>
                              <div class="tp-about-btn">
                                 <a class="tp-btn tp-btn-sm ${!isActive ? 'disabled' : ''}" href="/chapters/detail.html?id=${chapter.id}" ${!isActive ? 'style="pointer-events: none; opacity: 0.6;"' : ''}>Learn More</a>
                              </div>
                           </div>
                     </div>
                  `;
                  internationalContainer.appendChild(col);
               });
            } else {
               internationalContainer.innerHTML = '<div class="col-12"><p class="text-center">No international chapters available.</p></div>';
            }

            // Update members display
            const totalMembersEl = document.getElementById('chapters-total-members');
            const nationalMembersEl = document.getElementById('chapters-national-members');
            const internationalMembersEl = document.getElementById('chapters-international-members');
            
            if (totalMembersEl) {
               totalMembersEl.textContent = totalMembers > 0 ? totalMembers.toLocaleString() : '0';
            }
            if (nationalMembersEl) {
               nationalMembersEl.textContent = nationalMembers > 0 ? nationalMembers.toLocaleString() : '0';
            }
            if (internationalMembersEl) {
               internationalMembersEl.textContent = internationalMembers > 0 ? internationalMembers.toLocaleString() : '0';
            }

            // Hide loader and show sections
            if (loader) loader.style.display = 'none';
            if (internationalSection) internationalSection.style.display = 'block';
            if (nationalSection) nationalSection.style.display = 'block';
         } catch (error) {
            console.error('Error loading chapters:', error);
            // Hide loader and show sections even on error
            if (loader) loader.style.display = 'none';
            if (internationalSection) internationalSection.style.display = 'block';
            if (nationalSection) nationalSection.style.display = 'block';
            localContainer.innerHTML = '<div class="col-12"><p class="text-center">Unable to load chapters. Please try again later.</p></div>';
            internationalContainer.innerHTML = '<div class="col-12"><p class="text-center">Unable to load chapters. Please try again later.</p></div>';
         }
      }

      // Load chapters on page load
      loadChapters();

      // Collapsible functionality
      document.addEventListener('DOMContentLoaded', function() {
         const toggleButtons = document.querySelectorAll('.chapter-toggle-btn');
         const sectionHeaders = document.querySelectorAll('.chapter-section-header');
         
         function toggleSection(button) {
            const targetId = button.getAttribute('aria-controls');
            const content = document.getElementById(targetId);
            const isExpanded = button.getAttribute('aria-expanded') === 'true';
            
            if (isExpanded) {
               // Collapse
               content.classList.add('collapsed');
               button.setAttribute('aria-expanded', 'false');
            } else {
               // Expand
               content.classList.remove('collapsed');
               button.setAttribute('aria-expanded', 'true');
            }
         }
         
         toggleButtons.forEach(button => {
            button.addEventListener('click', function(e) {
               e.stopPropagation();
               toggleSection(this);
            });
         });

         sectionHeaders.forEach(header => {
            header.addEventListener('click', function(e) {
               // Only toggle if clicking on the header itself, not the button
               if (e.target.closest('.chapter-toggle-btn')) {
                  return;
               }
               const button = this.querySelector('.chapter-toggle-btn');
               if (button) {
                  toggleSection(button);
               }
            });
         });
      });
   </script>

</body>

</html>

